<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Plan d’expérience</title>
    <meta charset="utf-8" />
    <meta name="author" content="Marie-Pierre Etienne" />
    <script src="libs/header-attrs-2.11/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/metropolis.css" rel="stylesheet" />
    <script src="libs/xaringanExtra_fit-screen-0.2.6/fit-screen.js"></script>
    <link rel="stylesheet" href="mpe_pres.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Plan d’expérience
## pour tirer un maximum de profits d’une expérimentation
### Marie-Pierre Etienne
### <a href="https://github.com/marieetienne" class="uri">https://github.com/marieetienne</a>
### 2020/09/11 (updated: 2023-01-13)

---


name: intro

&lt;!-- F1D763 --&gt;
&lt;!-- F7A913 --&gt;
&lt;!-- C94326 --&gt;
&lt;!-- 1F908E --&gt;
&lt;!-- 33658A --&gt;







# Introduction : Importance du design expérimental 

--
## Retour sur un exemple : le gras du cochon !

.pull-left[

```
##       BFAT        GENET   
##  Min.   : 7.005   P0 :15  
##  1st Qu.:11.416   P25:23  
##  Median :13.360           
##  Mean   :13.827           
##  3rd Qu.:15.941           
##  Max.   :22.195
```
]


--

.pull-right[

* Ces données sont modélisées par `$$Y_{ik} = \mu_i + E_{ik}$$` 

* Intérêt pour `\(\delta = \mu_1-\mu_2\)` 

  - Estimation de `\(\delta\)` par `\(\hat{\delta}\)`
  - Loi de l'estimateur `\(D\)` de `\(\delta\)` : `\(\mathcal{N}\left (\delta, \sigma^2 \left(\frac{1}{n_2}+\frac{1}{n_1}\right)\right)\)`

* Dans l'exemple `\(n_1=15\)`, `\(n_2=23\)`, donc  `\(\frac{1}{n_1}+\frac{1}{n_2}= 0.110\)`
]

--
.pull-right[

* Si `\(n_1=19\)`  et `\(n_2=19\)`,  `\(\frac{1}{n_1}+\frac{1}{n_2}= 0.105\)`
]

--

`$$IC_{1-\alpha}(\delta)= \left[ \hat{\delta} - q_{1-\alpha/2} \hat{\sigma} \class{vert}{\sqrt{\frac{1}{n_1} +\frac{1}{n_2}}} ; 
\hat{\delta} + q_{1-\alpha/2} \hat{\sigma} \class{vert}{\sqrt{\frac{1}{n_1} +\frac{1}{n_2}}} \right]$$`

--

.rouge[ Gain en précision avec un design experimental bien choisi]

---
template: intro

## Retour sur la fréquence cardiaque et l'activité sportive

.pull-left[


```
## # A tibble: 4 × 3
## # Groups:   Activite [2]
##   Activite Sexe   nobs
##   &lt;fct&gt;    &lt;fct&gt; &lt;int&gt;
## 1 Natation F         4
## 2 Natation M         4
## 3 Pilates  F         4
## 4 Pilates  M         4
```
]

--

.pull-right[

* Ces données sont modélisées par `$$Y_{ik} = \mu + \alpha_i + \beta_j + \gamma_{ij}+ E_{ik},$$`  
cas particulier de `$$Y=X\theta +E.$$`

* Loi d l'estimateur `\(T\)` de `\(\theta\)`:  `\(\mathcal{N}\left(\theta, \sigma^2 (X^{\intercal} X)^{-1}\right)\)`

]

--

* `\(n_{ij}=4\)`, pour tout `\(i,j\)`. Plan d'expérience **équilibré** :séparation complète de la variabilité associée à l'effet du Sexe et de l'Activité.


&lt;img src="./RSS3_eq.png" width="40%" /&gt;

---

template: intro

## Retour sur la fréquence cardiaque et l'activité sportive



.pull-left[

* Que se passe-t-il si, dans notre expérience, on a le design suivant ?



```
## # A tibble: 4 × 3
##   Activite Sexe   nobs
##   &lt;fct&gt;    &lt;fct&gt; &lt;dbl&gt;
## 1 Natation F         8
## 2 Natation M         0
## 3 Pilates  F         0
## 4 Pilates  M         8
```




&lt;img src="./Rss_counfound.png" width="80%" /&gt;

et `\(X^{\intercal} X\)` n'est pas inversible (ereur dans les sorties R *aliased coefficient*)

]
--

.pull-right[

* Cas général : quand les effets ne sont ni complètement confondus ni tout à fait séparés.

&lt;img src="./RSS3.png" width="80%" /&gt;

]


--

.rouge[Le design expérimental est essentiel et doit être réfléchi en amont]


---
template: intro

## Retour sur la fréquence cardiaque et l'activité sportive

Plan d'expérience : 

```
## # A tibble: 4 × 3
## # Groups:   Activite [2]
##   Activite Sexe   nobs
##   &lt;fct&gt;    &lt;fct&gt; &lt;int&gt;
## 1 Natation F         4
## 2 Natation M         4
## 3 Pilates  F         4
## 4 Pilates  M         4
```

* Combien de paramètres à estimer dans le modèle suivant ?  `$$Y_{ik} = \mu + \alpha_i + \beta_j + \gamma_{ij}+ E_{ik},$$`  

--

* `$$DDL_{Res} =  ,$$` 

--

* Que se passerait-il si on avait exactement 4 observations ?

--
.rouge[Le modèle qui contient autant de paramètres que d'observations est appelé  modèle] .care[saturé].



---
template: intro

## Exemple de problème de design expérimental  : La Galette !

.vert[Objectif :] Réduire le nombre de galettes déchirées lorsqu'on les déplie


.pull-left[

Plusieurs aspects clés dans la recette :

  * Quantité d'eau (45%, 55%)
  * Température de cuisson (180, 220)
  * Etalement de la pâte (automatique, manuel)
  * Quantité de pâte déposée (55g, 65g)
  * Farine (bio, traditionnelle)
  * Pliage (à chaud, à froid)
  * Température de stockage (6 ou 15 degrés)

]

.pull-right[  
.vert[7 facteurs à deux modalités]
]
--

.center[
Combien de combinaisons possibles    
  
  * si on veut étudier .rouge[2] facteurs : 
  * si on veut étudier .rouge[3] facteurs : 
  * si on veut étudier .rouge[4] facteurs  :
]

---
template: intro

## Exemple de problème de design expérimental  : La Galette !

.vert[Objectif :] Réduire le nombre de galettes déchirées lorsqu'on les déplie

.pull-left[

Plusieurs aspects clés dans la recette :

  * Quantité d'eau (45%, 55%)
  * Température de cuisson (180, 220)
  * Etalement de la pâte (automatique, manuel)
  * Quantité de pâte déposée (55g, 65g)
  * Farine (bio, traditionnelle)
  * Pliage (à chaud, à froid)
  * Température de stockage (6 ou 15 degrés)

]

.pull-right[  
.vert[7 facteurs à deux modalités]
]



.center[
Combien de combinaisons possibles    
  
  * si on veut étudier .rouge[2] facteurs : `\(2^{\class{rouge}{2}}\)`
  * si on veut étudier .rouge[3] facteurs : `\(2^{\class{rouge}{3}}\)`
  * si on veut étudier .rouge[4] facteurs  : `\(2^{\class{rouge}{4}}\)`
  * si on veut étudier .rouge[7] facteurs  : `\(2^{\class{rouge}{7}}\)`
]



.care[Dans toute la suite, on va considérer des facteurs à 2 niveaux seulement.]




---
name: plan_complet
# Les plans factoriels complets `\(2^p\)`

--

## Cas de 2 facteurs : plan `\(2^2\)`

On note `\(A\)` le facteur 1 et `\(B\)` le facteur 2. Les modalités sont notées `\(1\)` et `\(-1\)`. 

On a `\(2^2\)` expériences différentes possibles:

### Matrice des essais

.pull-left[
`$$\begin{pmatrix} 
+1 &amp; +1 \\
+1 &amp; -1 \\
-1 &amp; +1 \\
-1 &amp; -1 \\
\end{pmatrix}$$`

] 

--

.pull-right[

A : Quantité d'eau, B : Pliage

* Essai 1 : 45% d'eau , pliage à chaud
* Essai 2 : 45% d'eau , pliage à froid
* Essai 3 : 55% d'eau , pliage à chaud
* Essai 4 : 55% d'eau , pliage à froid

]




---

template: plan_complet

## Cas de 2 facteurs : plan `\(2^2\)`

On note `\(A\)` le facteur 1 et `\(B\)` le facteur 2. Les modalités sont notées `\(1\)` et `\(-1\)`. 

On a `\(2^2\)` expériences différentes possibles: on peut estimer `\(2^2\)` paramètres.
--


Modèle d'analyse de la variance à 2 facteurs avec interaction  


`$$Y_{ij} = \mu + \alpha_i +\beta_j + \gamma_{ij} + E_{ij},$$`
#### Matrice de design, matrice des effets

C'est la matrice `\(X\)` dans le modèle qui est utilisé : `$$Y = X\theta + E$$`

.pull-left[

avec  les contraintes classiques de R : `\(\alpha_1=\beta_1=\gamma_{11}=\gamma_{12}=\gamma_{21}=0.\)` ]

.pull-right[

`$$X = \overset{\color{gray}{\begin{matrix}\mu &amp; \alpha_{2} &amp; \beta_2 &amp; \gamma_{22}\end{matrix}}}{\begin{pmatrix}
1 &amp; 0 &amp; 0 &amp; 0\\
1 &amp; 0 &amp; 1 &amp; 0\\
1 &amp; 1 &amp; 0 &amp; 0\\
1 &amp; 1 &amp; 1 &amp; 1\\
 \end{pmatrix}},\quad \theta =\begin{pmatrix}\mu \\ \alpha_2 \\ \beta_2 \\ \gamma_{22} \end{pmatrix}$$`

] 

--

Mais peu pratique dans le cadre des plans d'expérience.

.rouge[En acceptant de changer de système de contraintes, on pourra travailler plus facilement avec les plans !]


---

template: plan_complet


## Un petit retour sur l'analyse de la variance à 2 facteurs et au-delà


`$$Y_{ij} = \mu + \alpha_i +\beta_j + \gamma_{ij} + E_{ij},$$` 
   système de contraintes pour s'assurer que le modèle ne contient pas de paramètres inutiles

.pull-left[
.orange[Les contraintes classiques]

.font80[
et `\(\alpha_1=\beta_1=\gamma_{11}=\gamma_{12}=\gamma_{21}=0.\)` 

`$$X = \overset{\color{gray}{\begin{matrix}\mu &amp; \alpha_{2} &amp; \beta_2 &amp; \gamma_{22}\end{matrix}}}{\begin{pmatrix}
1 &amp; 0 &amp; 0 &amp; 0\\
1 &amp; 0 &amp; 1 &amp; 0\\
1 &amp; 1 &amp; 0 &amp; 0\\
1 &amp; 1 &amp; 1 &amp; 1\\
 \end{pmatrix}},\quad \theta =\begin{pmatrix}\mu \\ \alpha_2 \\ \beta_2 \\ \gamma_{22} \end{pmatrix}$$`
]
]

--


.pull-right[
.orange[Système alternatif commode pour  plans d'expérience]

.font80[ `\(\alpha_1 = -\alpha_2; \beta_1 = -\beta_2, \gamma_{11}=\gamma_{22}=-\gamma_{12}=-\gamma_{21};\)`

`$$X = \overset{\color{gray}{\begin{matrix}\ \mu \hspace{.3cm}&amp; \ \alpha_{1} \hspace{.3cm}&amp; \ \beta_1 \hspace{.3cm}&amp; \ \gamma_{11}\hspace{.3cm}\end{matrix}}}{\begin{pmatrix}
\ 1 &amp; \ 1 &amp; 1 &amp; 1\\
\ 1 &amp; \ 1 &amp; -1 &amp; -1\\
\ 1 &amp; -1 &amp; 1 &amp; -1\\
\ 1 &amp; -1 &amp; -1 &amp; 1\\
 \end{pmatrix}},\quad \theta =\begin{pmatrix}\mu \\ \alpha_1 \\ \beta_1 \\ \gamma_{11} \end{pmatrix}$$`
]

] 

.rouge[Les deux systèmes conduisent aux mêmes prédictions, aux mêmes tests sur les effets. L'interprétation des paramètres change.]


---

template: plan_complet


## Pourquoi c'est plus simple ?

--

### Cas de 2 facteurs : plan `\(2^2\)`

On note `\(\class{jaune}{A}\)` le facteur 1 et `\(\class{bleu}{B}\)` le facteur 2. Les modalités sont notées `\(1\)` et `\(-1\)`.




.pull-left[
#### Matrice des essais
.font80[

`$$\overset{\color{gray}{\begin{matrix} A\hspace{.3cm}&amp; B\hspace{.3cm} &amp; AB \end{matrix}}}{\begin{pmatrix} 
\class{jaune}{+1} &amp; \class{bleu}{+1}  &amp; \class{vert}{+1}\\
\class{jaune}{+1} &amp; \class{bleu}{-1}  &amp; \class{vert}{-1}\\
\class{jaune}{-1} &amp; \class{bleu}{+1}  &amp; \class{vert}{-1}\\
\class{jaune}{-1} &amp; \class{bleu}{-1}  &amp; \class{vert}{+1}\\
\end{pmatrix}}$$`
]

] 
--

.pull-right[

#### Matrice des effets du modèle d'anova à 2 facteurs


.font80[ 

`$$X = \overset{\color{gray}{\begin{matrix} \mu\hspace{.3cm}&amp; \alpha_{1} \hspace{.3cm} &amp; \beta_1 \hspace{.3cm} &amp; \gamma_{11} \end{matrix}}}{\begin{pmatrix}
\class{rouge}{1} &amp; \class{jaune}{1} &amp; \class{bleu}{1} &amp; \class{vert}{1}\\
\class{rouge}{1} &amp; \class{jaune}{1} &amp; \class{bleu}{-1} &amp; \class{vert}{-1}\\
\class{rouge}{1} &amp; \class{jaune}{-1} &amp; \class{bleu}{1} &amp; \class{vert}{-1}\\
\class{rouge}{1} &amp; \class{jaune}{-1} &amp; \class{bleu}{-1} &amp; \class{vert}{1}\\
 \end{pmatrix}}$$`
]

] 


---

template: plan_complet


## Soyons fous : plan complet pour 3 facteurs : plan `\(2^3\)`

On note `\(\class{jaune}{A}\)` le facteur 1,  `\(\class{bleu}{B}\)` le facteur 2,  `\(\class{orange}{C}\)` le facteur 3. Les modalités sont notées `\(1\)` et `\(-1\)`.

Combien de combinaisons possibles ?

--



.pull-left[
#### Matrice des essais
.font80[

`$$\overset{\color{gray}{\begin{matrix} A\hspace{.5cm}&amp; B\hspace{.5cm} &amp; C\hspace{.5cm} &amp; AB\hspace{.1cm} &amp; AC\hspace{.1cm} &amp; BC\hspace{.1cm} &amp; ABC \end{matrix}}}{\begin{pmatrix} 
 \class{jaune}{+1}&amp; \class{bleu}{+1} &amp; \class{orange}{+1} &amp; \class{vert}{+1}&amp; \class{jauneb}{+1}&amp; \class{bleuf}{+1} &amp; +1\\
\class{jaune}{+1}&amp; \class{bleu}{+1} &amp; \class{orange}{-1} &amp; \class{vert}{+1}&amp; \class{jauneb}{-1}&amp; \class{bleuf}{-1} &amp; -1\\
 \class{jaune}{+1}&amp; \class{bleu}{-1} &amp; \class{orange}{+1} &amp; \class{vert}{-1}&amp; \class{jauneb}{+1}&amp; \class{bleuf}{-1} &amp; -1\\
 \class{jaune}{+1}&amp; \class{bleu}{-1} &amp; \class{orange}{-1} &amp; \class{vert}{-1}&amp; \class{jauneb}{-1}&amp; \class{bleuf}{+1} &amp; +1\\
\class{jaune}{-1}&amp; \class{bleu}{+1} &amp; \class{orange}{+1} &amp; \class{vert}{+1}&amp; \class{jauneb}{-1}&amp; \class{bleuf}{+1}&amp; -1\\
 \class{jaune}{-1}&amp; \class{bleu}{+1} &amp; \class{orange}{-1} &amp; \class{vert}{+1}&amp; \class{jauneb}{+1}&amp; \class{bleuf}{-1} &amp; +1\\
 \class{jaune}{-1}&amp; \class{bleu}{-1} &amp; \class{orange}{+1} &amp; \class{vert}{-1}&amp; \class{jauneb}{-1}&amp; \class{bleuf}{-1} &amp; +1\\
 \class{jaune}{-1}&amp; \class{bleu}{-1} &amp; \class{orange}{-1} &amp; \class{vert}{-1}&amp; \class{jauneb}{+1}&amp; \class{bleuf}{+1}&amp; -1\\
\end{pmatrix}}$$`
]

] 
--

.pull-right[

#### Matrice des effets du modèle d'anova à 2 facteurs


.font80[ 

`$$X = {\begin{pmatrix}
\class{rouge}{1} &amp; \class{jaune}{1}&amp; \class{bleu}{1} &amp; \class{orange}{1} &amp; \class{vert}{1}&amp; \class{jauneb}{1}&amp; \class{bleuf}{1} &amp; 1\\
\class{rouge}{1} &amp; \class{jaune}{1}&amp; \class{bleu}{1} &amp; \class{orange}{-1} &amp; \class{vert}{1}&amp; \class{jauneb}{-1}&amp; \class{bleuf}{-1} &amp; -1\\
\class{rouge}{1} &amp; \class{jaune}{1}&amp; \class{bleu}{-1} &amp; \class{orange}{1} &amp; \class{vert}{-1}&amp; \class{jauneb}{1}&amp; \class{bleuf}{-1} &amp; -1\\
\class{rouge}{1} &amp; \class{jaune}{1}&amp; \class{bleu}{-1} &amp; \class{orange}{-1} &amp; \class{vert}{-1}&amp; \class{jauneb}{-1}&amp; \class{bleuf}{1} &amp; 1\\
\class{rouge}{1} &amp; \class{jaune}{-1}&amp; \class{bleu}{1} &amp; \class{orange}{1} &amp; \class{vert}{1}&amp; \class{jauneb}{-1}&amp; \class{bleuf}{1}&amp; -1\\
\class{rouge}{1} &amp; \class{jaune}{-1}&amp; \class{bleu}{1} &amp; \class{orange}{-1} &amp; \class{vert}{1}&amp; \class{jauneb}{1}&amp; \class{bleuf}{-1} &amp; 1\\
\class{rouge}{1} &amp; \class{jaune}{-1}&amp; \class{bleu}{-1} &amp; \class{orange}{1} &amp; \class{vert}{-1}&amp; \class{jauneb}{-1}&amp; \class{bleuf}{-1} &amp; 1\\
\class{rouge}{1} &amp; \class{jaune}{-1}&amp; \class{bleu}{-1} &amp; \class{orange}{-1} &amp; \class{vert}{-1}&amp; \class{jauneb}{1}&amp; \class{bleuf}{1}&amp; -1\\
 \end{pmatrix}}$$`
]

] 


---

template: plan_complet


## Conclusion sur les plans complets fractionnaires

- permet de considérer toutes les combinaisons de facteurs possibles

- on peut estimer jusque `\(2^p\)` paramètres : le modèle .rouge[saturé] correspondant est le  modèle d'analyse de la variance à p facteurs tenant en compte toutes les interactions d'ordre `\(2, 3, \ldots, p\)`.
--

## Remarques 

- le nombre d'expériences augmentent très vite : 
`$$\begin{align*}
2^2 &amp; = 4; \quad 2^3= 8 \\
2^4 &amp; = 16; \quad 2^5= 32 \\
2^6 &amp; = 64; \quad 2^7= 128 \\
\end{align*}$$`


- Toutes les interactions ne sont peut être pas utiles.

- Peut on gagner un peu sur le nombre d'expériences ?


---
name: plan_fractionnaire
# Plan fractionnaire `\(2^{p-k}\)`

--

## Plan à .rouge[3] facteurs en 4 essais : `\(2^{\class{rouge}{3}-\class{jaune}{1}}\)`

.pull-left[

* Chaque niveau du facteur apparaît le même nombre de fois,
* Chaque combinaison de deux facteurs apparaît le même nombre de fois


]


.pull-right[
#### Matrice des essais
.font80[

`$$\overset{\color{gray}{\begin{matrix} A\hspace{.5cm}&amp; B\hspace{.5cm} &amp; C\hspace{.5cm} \end{matrix}}}{\begin{pmatrix} 
 \class{jaune}{+1}&amp; \class{bleu}{+1} &amp; \class{orange}{+1}\\
\class{jaune}{+1}&amp; \class{bleu}{+1} &amp; \class{orange}{-1} \\
 \class{jaune}{+1}&amp; \class{bleu}{-1} &amp; \class{orange}{+1}\\
 \class{jaune}{+1}&amp; \class{bleu}{-1} &amp; \class{orange}{-1}\\
\class{jaune}{-1}&amp; \class{bleu}{+1} &amp; \class{orange}{+1}\\
 \class{jaune}{-1}&amp; \class{bleu}{+1} &amp; \class{orange}{-1}\\
 \class{jaune}{-1}&amp; \class{bleu}{-1} &amp; \class{orange}{+1}\\
 \class{jaune}{-1}&amp; \class{bleu}{-1} &amp; \class{orange}{-1}\\
\end{pmatrix}}$$`
]
]

--

.rouge[Pas si simple]


---
template: plan_fractionnaire


## Mécanique de construction `\(2^{\class{rouge}{p}-\class{jaune}{k}}\)`

1. Choisir un plan de base : plan complet à `\(2^{\class{rouge}{p}-\class{jaune}{k}}\)`
--

2. Construire la matrice des effets du modèle saturé pour ce plan de base 

--

3. Identifier des interactions que l'on peut confondre avec des effets principaux

--

4. Détermination des confusions induites



---
template: plan_fractionnaire

## Retour sur le plan à 4 essais : `\(2^{\class{rouge}{3}-\class{jaune}{1}}\)`

--


*1.* Choisir un plan de base en `\(2^2\)` essais

--
.pull-left[
*2.* Matrice des effets du modèle saturé correspondant 

.font80[

`$$X = \overset{\color{gray}{\begin{matrix} I\hspace{.3cm}&amp; A \hspace{.3cm} &amp; B \hspace{.3cm} &amp; AB \end{matrix}}}{\begin{pmatrix}
\class{rouge}{1} &amp; \class{jaune}{1} &amp; \class{bleu}{1} &amp; \class{vert}{1}\\
\class{rouge}{1} &amp; \class{jaune}{1} &amp; \class{bleu}{-1} &amp; \class{vert}{-1}\\
\class{rouge}{1} &amp; \class{jaune}{-1} &amp; \class{bleu}{1} &amp; \class{vert}{-1}\\
\class{rouge}{1} &amp; \class{jaune}{-1} &amp; \class{bleu}{-1} &amp; \class{vert}{1}\\
 \end{pmatrix}}$$`
]
]

--

.pull-right[

*3.* On confond C avec AB

.font80[

`$$X = \overset{\color{gray}{\begin{matrix} I\hspace{.3cm}&amp; A \hspace{.3cm} &amp; B \hspace{.3cm} &amp; \begin{matrix} \class{barre}{AB} \\ \class{vert} C \end{matrix} \end{matrix}}}{\begin{pmatrix}
\class{rouge}{1} &amp; \class{jaune}{1} &amp; \class{bleu}{1} &amp; \class{vert}{1}\\
\class{rouge}{1} &amp; \class{jaune}{1} &amp; \class{bleu}{-1} &amp; \class{vert}{-1}\\
\class{rouge}{1} &amp; \class{jaune}{-1} &amp; \class{bleu}{1} &amp; \class{vert}{-1}\\
\class{rouge}{1} &amp; \class{jaune}{-1} &amp; \class{bleu}{-1} &amp; \class{vert}{1}\\
 \end{pmatrix}}$$`
]
]
 
--

*4.* Identification des confusions induites 

C est  confondu avec AB, on écrit  
`\(C = AB\)` 



---
template: plan_fractionnaire

## Retour sur le plan à 4 essais : `\(2^{\class{rouge}{3}-\class{jaune}{1}}\)`

on a donc `\(C= AB\)` donc `\(CC = C(AB)= ABC\)` donc `\(I= ABC\)`.


Ceci induit d'autres confusions:
.pull-left[

* `\(A(I) = A(ABC)\)` donc `\(A = (AA)BC\)` donc `\(A = BC\)`
]

.pull-right[
* `\(B(I) = B(ABC)\)` donc `\(B = AC\)`
]

--
.font80[

`$$X = \overset{\color{gray}{\begin{matrix} \begin{matrix} \class{rouge}{I} \\ \class{rouge}{ABC} \end{matrix} &amp;\begin{matrix} \class{jaune}{A} \\ \class{jaune}{BC} \end{matrix}  &amp; \begin{matrix} \class{bleu}{B} \\ \class{bleu}{AC} \end{matrix}  &amp; \begin{matrix} \class{vert}{AB} \\ \class{vert} C \end{matrix} \end{matrix}}}{\begin{pmatrix}
\class{rouge}{1} &amp; \class{jaune}{1} &amp; \class{bleu}{1} &amp; \class{vert}{1}\\
\class{rouge}{1} &amp; \class{jaune}{1} &amp; \class{bleu}{-1} &amp; \class{vert}{-1}\\
\class{rouge}{1} &amp; \class{jaune}{-1} &amp; \class{bleu}{1} &amp; \class{vert}{-1}\\
\class{rouge}{1} &amp; \class{jaune}{-1} &amp; \class{bleu}{-1} &amp; \class{vert}{1}\\
 \end{pmatrix}}$$`
]

--

.rouge[Générateur d'alias]: `\(ABC= I\)`, ABC est un générateur d'alias

.font80[

`$$X = \overset{\color{gray}{\begin{matrix} \begin{matrix} \class{rouge}{I}\end{matrix} \hspace{.1cm}&amp;\begin{matrix} \class{jaune}{A} \end{matrix} \hspace{.2cm} &amp; \begin{matrix} \class{bleu}{B} \end{matrix}  \hspace{.2cm}&amp; \begin{matrix}  \class{vert} C \end{matrix}\hspace{.2cm} &amp; \begin{matrix} \class{vert}{AB}  \end{matrix} \hspace{.1cm}&amp; \begin{matrix}  \class{bleu}{AC} \end{matrix} \hspace{.1cm}&amp; \begin{matrix}  \class{jaune}{BC} \end{matrix} \hspace{.1cm}\begin{matrix} \class{rouge}{ABC}\end{matrix} \end{matrix}}}{\begin{pmatrix}
\class{rouge}{1} &amp; \class{jaune}{1} &amp; \class{bleu}{1} &amp; \class{vert}{1}&amp; \class{vert}{1}&amp; \class{bleu}{1}&amp; \class{jaune}{1} &amp; \class{rouge}{1}\\
\class{rouge}{1} &amp; \class{jaune}{1} &amp; \class{bleu}{-1} &amp; \class{vert}{-1}&amp; \class{vert}{-1}&amp; \class{bleu}{1}&amp; \class{jaune}{1} &amp; \class{rouge}{1}\\
\class{rouge}{1} &amp; \class{jaune}{-1} &amp; \class{bleu}{1} &amp; \class{vert}{-1}&amp; \class{vert}{-1}&amp; \class{bleu}{-1}&amp; \class{jaune}{-1} &amp; \class{rouge}{1}\\
\class{rouge}{1} &amp; \class{jaune}{-1} &amp; \class{bleu}{-1} &amp; \class{vert}{1}&amp; \class{vert}{1}&amp; \class{bleu}{1}&amp; \class{jaune}{-1} &amp; \class{rouge}{1}\\
 \end{pmatrix}}$$`
]



---
template: plan_fractionnaire

## Plan fractionnaire `\(2^{\class{rouge}{4}-\class{jaune}{1}}\)`

4 facteurs en 8 essais 

--

*1.* Choisir un plan de base en `\(2^3\)` essais

--
.pull-left[
*2.* Matrice des effets du modèle saturé correspondant 

.font80[ 

`$$X = \overset{\color{gray}{\begin{matrix} \begin{matrix} \class{rouge}{I}  \end{matrix}\hspace{.2cm}  &amp;\begin{matrix} \class{jaune}{A} \end{matrix} \hspace{.2cm}  &amp; \begin{matrix} \class{bleu}{B} \end{matrix} \hspace{.2cm} &amp; \begin{matrix} \class{orange}{C} \end{matrix} \hspace{.2cm} &amp;  &amp; \begin{matrix} \class{vert}{AB} \end{matrix} \hspace{.1cm} &amp;   \begin{matrix} \class{jaune}{AC} \end{matrix} \hspace{.1cm} &amp; \begin{matrix} \class{bleuf}{BC} \end{matrix} \hspace{.1cm} &amp;  \begin{matrix} {ABC} \end{matrix}   \end{matrix}}}{\begin{pmatrix}
\class{rouge}{1} &amp; \class{jaune}{1}&amp; \class{bleu}{1} &amp; \class{orange}{1} &amp; \class{vert}{1}&amp; \class{jauneb}{1}&amp; \class{bleuf}{1} &amp; 1\\
\class{rouge}{1} &amp; \class{jaune}{1}&amp; \class{bleu}{1} &amp; \class{orange}{-1} &amp; \class{vert}{1}&amp; \class{jauneb}{-1}&amp; \class{bleuf}{-1} &amp; -1\\
\class{rouge}{1} &amp; \class{jaune}{1}&amp; \class{bleu}{-1} &amp; \class{orange}{1} &amp; \class{vert}{-1}&amp; \class{jauneb}{1}&amp; \class{bleuf}{-1} &amp; -1\\
\class{rouge}{1} &amp; \class{jaune}{1}&amp; \class{bleu}{-1} &amp; \class{orange}{-1} &amp; \class{vert}{-1}&amp; \class{jauneb}{-1}&amp; \class{bleuf}{1} &amp; 1\\
\class{rouge}{1} &amp; \class{jaune}{-1}&amp; \class{bleu}{1} &amp; \class{orange}{1} &amp; \class{vert}{1}&amp; \class{jauneb}{-1}&amp; \class{bleuf}{1}&amp; -1\\
\class{rouge}{1} &amp; \class{jaune}{-1}&amp; \class{bleu}{1} &amp; \class{orange}{-1} &amp; \class{vert}{1}&amp; \class{jauneb}{1}&amp; \class{bleuf}{-1} &amp; 1\\
\class{rouge}{1} &amp; \class{jaune}{-1}&amp; \class{bleu}{-1} &amp; \class{orange}{1} &amp; \class{vert}{-1}&amp; \class{jauneb}{-1}&amp; \class{bleuf}{-1} &amp; 1\\
\class{rouge}{1} &amp; \class{jaune}{-1}&amp; \class{bleu}{-1} &amp; \class{orange}{-1} &amp; \class{vert}{-1}&amp; \class{jauneb}{1}&amp; \class{bleuf}{1}&amp; -1\\
 \end{pmatrix}}$$`
]
]


---
count: false
template: plan_fractionnaire

## Plan fractionnaire `\(2^{\class{rouge}{4}-\class{jaune}{1}}\)`

4 facteurs en 8 essais 


*1.* Choisir un plan de base en `\(2^3\)` essais


.pull-left[
*2.* Matrice des effets du modèle saturé correspondant 

.font70[ 

`$$X = \overset{\color{gray}{\begin{matrix} \begin{matrix} \class{rouge}{I}  \end{matrix}\hspace{.2cm}  &amp;\begin{matrix} \class{jaune}{A} \end{matrix} \hspace{.2cm}  &amp; \begin{matrix} \class{bleu}{B} \end{matrix} \hspace{.2cm} &amp; \begin{matrix} \class{orange}{C} \end{matrix} \hspace{.2cm} &amp;  &amp; \begin{matrix} \class{vert}{AB} \end{matrix} \hspace{.1cm} &amp;   \begin{matrix} \class{jaune}{AC} \end{matrix} \hspace{.1cm} &amp; \begin{matrix} \class{bleuf}{BC} \end{matrix} \hspace{.1cm} &amp;  \begin{matrix} {ABC} \end{matrix}   \end{matrix}}}{\begin{pmatrix}
\class{rouge}{1} &amp; \class{jaune}{1}&amp; \class{bleu}{1} &amp; \class{orange}{1} &amp; \class{vert}{1}&amp; \class{jauneb}{1}&amp; \class{bleuf}{1} &amp; 1\\
\class{rouge}{1} &amp; \class{jaune}{1}&amp; \class{bleu}{1} &amp; \class{orange}{-1} &amp; \class{vert}{1}&amp; \class{jauneb}{-1}&amp; \class{bleuf}{-1} &amp; -1\\
\class{rouge}{1} &amp; \class{jaune}{1}&amp; \class{bleu}{-1} &amp; \class{orange}{1} &amp; \class{vert}{-1}&amp; \class{jauneb}{1}&amp; \class{bleuf}{-1} &amp; -1\\
\class{rouge}{1} &amp; \class{jaune}{1}&amp; \class{bleu}{-1} &amp; \class{orange}{-1} &amp; \class{vert}{-1}&amp; \class{jauneb}{-1}&amp; \class{bleuf}{1} &amp; 1\\
\class{rouge}{1} &amp; \class{jaune}{-1}&amp; \class{bleu}{1} &amp; \class{orange}{1} &amp; \class{vert}{1}&amp; \class{jauneb}{-1}&amp; \class{bleuf}{1}&amp; -1\\
\class{rouge}{1} &amp; \class{jaune}{-1}&amp; \class{bleu}{1} &amp; \class{orange}{-1} &amp; \class{vert}{1}&amp; \class{jauneb}{1}&amp; \class{bleuf}{-1} &amp; 1\\
\class{rouge}{1} &amp; \class{jaune}{-1}&amp; \class{bleu}{-1} &amp; \class{orange}{1} &amp; \class{vert}{-1}&amp; \class{jauneb}{-1}&amp; \class{bleuf}{-1} &amp; 1\\
\class{rouge}{1} &amp; \class{jaune}{-1}&amp; \class{bleu}{-1} &amp; \class{orange}{-1} &amp; \class{vert}{-1}&amp; \class{jauneb}{1}&amp; \class{bleuf}{1}&amp; -1\\
 \end{pmatrix}}$$`
]
]

.pull-right[
*3.* On confond D et ABC 

.font80[ 

`$$X = \overset{\color{gray}{\begin{matrix} \begin{matrix} \class{rouge}{I}  \end{matrix}\hspace{.2cm}  &amp;\begin{matrix} \class{jaune}{A} \end{matrix} \hspace{.2cm}  &amp; \begin{matrix} \class{bleu}{B} \end{matrix} \hspace{.2cm} &amp; \begin{matrix} \class{orange}{C} \end{matrix} \hspace{.2cm} &amp;  &amp; \begin{matrix} \class{vert}{AB} \end{matrix} \hspace{.1cm} &amp;   \begin{matrix} \class{jaune}{AC} \end{matrix} \hspace{.1cm} &amp; \begin{matrix} \class{bleuf}{BC} \end{matrix} \hspace{.1cm} &amp;  \begin{matrix} {ABC} \\ D \end{matrix}   \end{matrix}}}{\begin{pmatrix}
\class{rouge}{1} &amp; \class{jaune}{1}&amp; \class{bleu}{1} &amp; \class{orange}{1} &amp; \class{vert}{1}&amp; \class{jauneb}{1}&amp; \class{bleuf}{1} &amp; 1\\
\class{rouge}{1} &amp; \class{jaune}{1}&amp; \class{bleu}{1} &amp; \class{orange}{-1} &amp; \class{vert}{1}&amp; \class{jauneb}{-1}&amp; \class{bleuf}{-1} &amp; -1\\
\class{rouge}{1} &amp; \class{jaune}{1}&amp; \class{bleu}{-1} &amp; \class{orange}{1} &amp; \class{vert}{-1}&amp; \class{jauneb}{1}&amp; \class{bleuf}{-1} &amp; -1\\ 
\class{rouge}{1} &amp; \class{jaune}{1}&amp; \class{bleu}{-1} &amp; \class{orange}{-1} &amp; \class{vert}{-1}&amp; \class{jauneb}{-1}&amp; \class{bleuf}{1} &amp; 1\\
\class{rouge}{1} &amp; \class{jaune}{-1}&amp; \class{bleu}{1} &amp; \class{orange}{1} &amp; \class{vert}{1}&amp; \class{jauneb}{-1}&amp; \class{bleuf}{1}&amp; -1\\
\class{rouge}{1} &amp; \class{jaune}{-1}&amp; \class{bleu}{1} &amp; \class{orange}{-1} &amp; \class{vert}{1}&amp; \class{jauneb}{1}&amp; \class{bleuf}{-1} &amp; 1\\
\class{rouge}{1} &amp; \class{jaune}{-1}&amp; \class{bleu}{-1} &amp; \class{orange}{1} &amp; \class{vert}{-1}&amp; \class{jauneb}{-1}&amp; \class{bleuf}{-1} &amp; 1\\
\class{rouge}{1} &amp; \class{jaune}{-1}&amp; \class{bleu}{-1} &amp; \class{orange}{-1} &amp; \class{vert}{-1}&amp; \class{jauneb}{1}&amp; \class{bleuf}{1}&amp; -1\\
 \end{pmatrix}}$$`
]
]


---
template: plan_fractionnaire

## Plan fractionnaire `\(2^{\class{rouge}{4}-\class{jaune}{1}}\)`

### Confusion d'effet (alias) et générateur d'alias 

*4.* Confusions induites 

* `\(D = ABC\)` donc `\(DD = ABCD\)` donc `\(I=ABCD\)`

`\(ABCD\)` est un .rouge[générateur d'alias]

--

.pull-left[
* `\(AI = AABCD\)` donc `\(A = BCD\)`

* `\(BI = BABCD\)` donc `\(B = ACD\)`

* `\(CI = CABCD\)` donc `\(C = ABD\)` ]

.pull-right[

* `\(AD= AABC\)` donc `\(AD=BC\)`

* `\(BD= BABC\)` donc `\(BD=AC\)`

* `\(CD= CABC\)` donc `\(CD=AB\)`

]

--

Les effets principaux sont confondus avec des interactions d'ordre 3 

les interactions d'ordre 2 sont confondues avec d'autres interactions d'ordre 2


---
template: plan_fractionnaire

## Nombre de facteurs et nombre d'essais

Un plan est caractérisée par sa résolution :

.rouge[La résolution d'un plan est la longueur du plus petit générateur d'alias]

--

### Des repères pour ne rien oublier 

* Nombre de générateurs : `\(2^{facteurs\ additionnels}-1\)`
* Plan Résolution III : les effets principaux sont confondus avec les interactions d’ordre 2 ou plus
* Plan Résolution IV : les effets principaux sont confondus avec les interactions d’ordre 3 ou plus
* Plan Résolution V : les effets principaux sont confondus avec les interactions d’ordre 4 ou plus

--

.center[Parle à ta main]






---
template: plan_fractionnaire

## Soyons fous : plan fractionnaire `\(2^{\class{rouge}{5}-\class{jaune}{2}}\)`

---
template: plan_fractionnaire

## Soyons fous : plan fractionnaire `\(2^{\class{rouge}{5}-\class{jaune}{2}}\)`


---

# Dans une démarche expérimentale 

1. On formalise la question, on identifie les facteurs potentiellement intéessants

--

2. On met en place le plan d'expérience

--

3. On réalise les manips

--

4. On analyse les résultats



---

# Ce qu'il faut absolument savoir pour les TDs


* Ecrire la matrice des essais et matrice des effets

* Déterminer les confusion d'effets et de générateurs d'alias

* La notion de résolution d'un plan

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="../courses_tools/resources/collapseoutput.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:10",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
